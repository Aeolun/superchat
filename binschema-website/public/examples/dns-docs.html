<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DNS Protocol</title>
  <style>
    /* Protocol Documentation Styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      line-height: 1.6;
      color: #333;
      background: #f5f5f5;
      padding: 20px;
    }

    .protocol-header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 40px 20px;
      border-radius: 8px;
      margin-bottom: 30px;
      text-align: center;
    }

    .protocol-header h1 {
      font-size: 2.5em;
      margin-bottom: 10px;
    }

    .protocol-version {
      font-size: 1.2em;
      opacity: 0.9;
    }

    .toc {
      background: white;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 30px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .toc h2 {
      margin-bottom: 15px;
      color: #667eea;
    }

    .toc ul {
      list-style: none;
    }

    .toc li {
      margin: 8px 0;
    }

    .toc a {
      color: #667eea;
      text-decoration: none;
      padding: 5px 10px;
      display: inline-block;
      border-radius: 4px;
      transition: background 0.2s;
    }

    .toc a:hover {
      background: #f0f0f0;
    }

    main {
      background: white;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .section {
      margin-bottom: 50px;
    }

    .section h2 {
      color: #667eea;
      border-bottom: 2px solid #667eea;
      padding-bottom: 10px;
      margin-bottom: 20px;
    }

    .section h3 {
      color: #764ba2;
      margin: 30px 0 15px 0;
    }

    .wire-format {
      background: #f9f9f9;
      border-top: 1px solid #ddd;
      border-bottom: 1px solid #ddd;
      padding: 20px;
      margin: 20px 0;
      overflow-x: auto;
    }

    .wire-diagram {
      display: flex;
      flex-direction: row;
      gap: 0;
      min-width: 100%;
      margin-bottom: 15px;
    }

    .field {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border: 2px solid #555;
      border-right: none;
      padding: 12px 8px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      min-height: 80px;
      position: relative;
      box-sizing: border-box;
    }

    .field:last-child {
      border-right: 2px solid #555;
    }

    .field.conditional {
      background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
    }

    .field-name {
      font-weight: bold;
      color: white;
      font-size: 0.9em;
      margin-bottom: 4px;
      word-wrap: break-word;
      max-width: 100%;
    }

    .field-type {
      font-family: 'Courier New', monospace;
      color: rgba(255, 255, 255, 0.9);
      font-size: 0.75em;
      margin-bottom: 2px;
    }

    .field-size {
      color: rgba(255, 255, 255, 0.7);
      font-size: 0.7em;
      font-weight: 600;
    }

    .field-desc {
      margin-top: 8px;
      color: #555;
      font-size: 0.95em;
      line-height: 1.5;
    }

    .field-condition {
      margin-top: 6px;
      padding: 6px 10px;
      background: #fef3c7;
      border-radius: 4px;
      font-family: 'Courier New', monospace;
      font-size: 0.85em;
      color: #92400e;
      border: 1px solid #fbbf24;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
    }

    th, td {
      padding: 12px;
      text-align: left;
      border-bottom: 1px solid #ddd;
    }

    th {
      background: #667eea;
      color: white;
      font-weight: 600;
    }

    tr:hover {
      background: #f9f9f9;
    }

    code {
      background: #f0f0f0;
      padding: 2px 6px;
      border-radius: 3px;
      font-family: 'Courier New', monospace;
      font-size: 0.9em;
    }

    .type-link {
      color: #667eea;
      text-decoration: none;
      border-bottom: 1px dashed #667eea;
      transition: all 0.2s;
    }

    .type-link:hover {
      color: #764ba2;
      border-bottom-color: #764ba2;
      border-bottom-style: solid;
    }

    /* Type links inside field diagrams need high contrast on colored backgrounds */
    .field-type .type-link {
      color: #fde047;
      border-bottom-color: rgba(253, 224, 71, 0.6);
    }

    .field-type .type-link:hover {
      color: #ffffff;
      border-bottom-color: #ffffff;
    }

    details {
      margin: 15px 0;
    }

    summary {
      cursor: pointer;
      user-select: none;
      padding: 10px;
      background: #f9f9f9;
      border-radius: 4px;
      transition: background 0.2s;
    }

    summary:hover {
      background: #f0f0f0;
    }

    summary h3, summary h4 {
      display: inline;
      margin: 0;
    }

    .example summary {
      border-radius: 0;
    }

    .message-details {
      border: 1px solid #ddd;
      border-radius: 6px;
      padding: 0;
      margin: 15px 0;
    }

    .message-details summary {
      background: #f5f5f5;
    }

    .message-details[open] summary {
      border-bottom: 1px solid #ddd;
    }

    .message-details[open] .example summary {
      border-bottom: 0;
    }

    .message-details[open] .example[open] summary {
      border-bottom: 1px solid #ddd;
    }

    .message-description {
      font-size: 1.1em;
      margin: 15px 0;
      padding: 0 15px;
    }

    .message-notes {
      background: #eff6ff;
      border-left: 4px solid #3b82f6;
      padding: 12px;
      margin: 15px;
      border-radius: 4px;
    }

    .notes-list {
      margin: 0;
      padding-left: 20px;
      list-style-type: disc;
    }

    .notes-list li {
      margin: 8px 0;
      line-height: 1.6;
    }

    .generic-badge {
      font-size: 0.7em;
      background: #fbbf24;
      color: #78350f;
      padding: 2px 8px;
      border-radius: 3px;
      font-weight: 600;
      margin-left: 8px;
    }

    .example {
      margin: 20px 0;
      border-top: 1px solid #ddd;
      border-bottom: 1px solid #ddd;
    }

    .example-content {
      padding: 20px;
    }

    .example-content > p {
      margin: 0 0 15px 0;
    }

    .example h5 {
      margin: 15px 0 10px 0;
      font-size: 1em;
      color: #555;
      font-weight: 600;
    }

    .example-hex,
    .example-decoded {
      margin: 15px 0;
    }

    .annotated-hex-view {
      margin: 15px 0;
    }

    .hex-inline {
      display: inline-flex;
      flex-wrap: wrap;
      gap: 0.5em;
      font-family: 'Monaco', 'Menlo', 'Courier New', monospace;
      font-size: 0.95em;
      line-height: 1.8;
      padding: 12px;
      background: #f8f9fa;
      border-radius: 4px;
      overflow-x: auto;
      margin-bottom: 15px;
    }

    .hex-segment {
      padding: 4px 6px;
      border-radius: 3px;
      cursor: pointer;
      transition: all 0.15s;
      border: 2px solid transparent;
      line-height: 1em;
    }

    .binary-icon {
      width: 1em;
      height: 1em;
      display: inline-block;
      vertical-align: middle;
      margin-right: 4px;
    }

    .hex-segment:hover,
    .hex-segment.highlight {
      border-color: rgba(0, 0, 0, 0.3);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .hex-annotations {
      background: #ffffff;
      border: 1px solid #e5e7eb;
      border-radius: 4px;
      padding: 8px;
    }

    .annotation {
      padding: 8px 12px;
      margin: 4px 0;
      border-left: 4px solid #ddd;
      background: #f9fafb;
      border-radius: 0 4px 4px 0;
      cursor: pointer;
      transition: all 0.15s;
    }

    .annotation:hover,
    .annotation.highlight {
      background: #f3f4f6;
      transform: translateX(4px);
    }

    .annotation strong {
      font-family: 'Monaco', 'Menlo', 'Courier New', monospace;
      font-size: 0.9em;
      color: #4b5563;
    }

    .bitfield-list {
      margin: 8px 0 0 0;
      padding-left: 20px;
      list-style-type: disc;
    }

    .bitfield-list li {
      margin: 4px 0;
      font-size: 0.9em;
      color: #374151;
    }

    .bitfield-list code {
      background: #e5e7eb;
      padding: 1px 4px;
      border-radius: 2px;
      font-size: 0.85em;
    }

    .hex-dump {
      background: #1e1e1e;
      color: #d4d4d4;
      padding: 15px;
      border-radius: 4px;
      overflow-x: auto;
      font-family: 'Courier New', monospace;
      font-size: 0.9em;
      line-height: 1.4;
    }

    .decoded {
      background: #f9f9f9;
      padding: 15px;
      border-radius: 4px;
      overflow-x: auto;
      font-family: 'Courier New', monospace;
      font-size: 0.9em;
    }

    .error {
      color: #dc2626;
      background: #fee2e2;
      padding: 10px;
      border-radius: 4px;
      border-left: 4px solid #dc2626;
    }

    footer {
      text-align: center;
      padding: 20px;
      color: #999;
      margin-top: 40px;
    }
  </style>
  <script>
    // Auto-open details elements when navigating to type anchors
    document.addEventListener('DOMContentLoaded', () => {
      // Handle initial load with hash
      if (window.location.hash) {
        const target = document.querySelector(window.location.hash);
        if (target && target.tagName === 'DETAILS') {
          target.open = true;
          target.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
      }

      // Handle hash changes (clicking type links)
      window.addEventListener('hashchange', () => {
        const target = document.querySelector(window.location.hash);
        if (target && target.tagName === 'DETAILS') {
          target.open = true;
          target.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
      });
    });
  </script>
</head>
<body>
  <header class="protocol-header">
    <h1>DNS Protocol</h1>
    <div class="protocol-version">Version RFC 1035</div>
  </header>

  <nav class="toc">
    <h2>Table of Contents</h2>
    <ul>
      <li><a href="#overview">Overview</a></li>
      <li><a href="#frame-format">Frame Format</a></li>
      <li><a href="#data-types">Data Types</a></li>
      <li><a href="#messages">Messages</a></li>
    </ul>
  </nav>

  <main>
    <section id="overview" class="section">
      <h2>Overview</h2>
      <p>Domain Name System (DNS) protocol for resolving domain names to IP addresses and other resource records. DNS uses a distributed database organized in a hierarchical tree structure of domains.</p>
      <div class="notes">
    <ul class="notes-list">
      <li><strong>Byte order:</strong> All multi-byte integers use big-endian (network byte order) as specified in RFC 1035 section 2.3.2.</li>
      <li><strong>Domain name encoding:</strong> Labels are prefixed with their length (max 63 bytes per label). Total domain name is max 255 octets. Domain names end with a zero-length label (0x00).</li>
      <li><strong>Message compression:</strong> DNS uses compression to eliminate repetition of domain names. A pointer is 2 octets starting with bits 11, followed by a 14-bit offset from the start of the message (section 4.1.4).</li>
      <li><strong>Transport:</strong> DNS uses UDP port 53 for standard queries and TCP port 53 for zone transfers. UDP messages are limited to 512 bytes (EDNS0 can increase this).</li>
      <li><strong>Case insensitivity:</strong> All DNS comparisons between character strings (labels, domain names) are case-insensitive. However, original case should be preserved when possible.</li>
      <li><strong>Size limits:</strong> Labels are 63 octets or less. Complete domain names are 255 octets or less. TTL is a positive value of a signed 32-bit number. UDP messages are 512 octets or less without EDNS0.</li>
      <li><strong>Message format:</strong> All DNS messages have the same 5-section format: Header (always present), Question (query parameters), Answer (RRs answering the question), Authority (RRs pointing toward an authority), Additional (RRs holding additional information).</li>
      <li><strong>Bitfield packing:</strong> The flags in bytes 2-3 of the header are packed as: QR(1) | Opcode(4) | AA(1) | TC(1) | RD(1) | RA(1) | Z(3) | RCODE(4)</li>
    </ul>
      </div>
    </section>

    <section id="frame-format" class="section">
      <h2>Frame Format</h2>
      <p>All messages use the following frame-based format:</p>

      <div class="wire-format">
        <div class="wire-diagram">
          <div class="field" style="flex: 2">
            <div class="field-name">id</div>
            <div class="field-type">uint16</div>
            <div class="field-size">2 bytes</div>
          </div>
          <div class="field" style="flex: 1">
            <div class="field-name">qr</div>
            <div class="field-type">bit&lt;1&gt;</div>
            <div class="field-size">1 bits</div>
          </div>
          <div class="field" style="flex: 1">
            <div class="field-name">opcode</div>
            <div class="field-type">bit&lt;4&gt;</div>
            <div class="field-size">4 bits</div>
          </div>
          <div class="field" style="flex: 1">
            <div class="field-name">aa</div>
            <div class="field-type">bit&lt;1&gt;</div>
            <div class="field-size">1 bits</div>
          </div>
          <div class="field" style="flex: 1">
            <div class="field-name">tc</div>
            <div class="field-type">bit&lt;1&gt;</div>
            <div class="field-size">1 bits</div>
          </div>
          <div class="field" style="flex: 1">
            <div class="field-name">rd</div>
            <div class="field-type">bit&lt;1&gt;</div>
            <div class="field-size">1 bits</div>
          </div>
          <div class="field" style="flex: 1">
            <div class="field-name">ra</div>
            <div class="field-type">bit&lt;1&gt;</div>
            <div class="field-size">1 bits</div>
          </div>
          <div class="field" style="flex: 1">
            <div class="field-name">z</div>
            <div class="field-type">bit&lt;3&gt;</div>
            <div class="field-size">3 bits</div>
          </div>
          <div class="field" style="flex: 1">
            <div class="field-name">rcode</div>
            <div class="field-type">bit&lt;4&gt;</div>
            <div class="field-size">4 bits</div>
          </div>
          <div class="field" style="flex: 2">
            <div class="field-name">qdcount</div>
            <div class="field-type">uint16</div>
            <div class="field-size">2 bytes</div>
          </div>
          <div class="field" style="flex: 2">
            <div class="field-name">ancount</div>
            <div class="field-type">uint16</div>
            <div class="field-size">2 bytes</div>
          </div>
          <div class="field" style="flex: 2">
            <div class="field-name">nscount</div>
            <div class="field-type">uint16</div>
            <div class="field-size">2 bytes</div>
          </div>
          <div class="field" style="flex: 2">
            <div class="field-name">arcount</div>
            <div class="field-type">uint16</div>
            <div class="field-size">2 bytes</div>
          </div>
          <div class="field" style="flex: 8">
            <div class="field-name">payload</div>
            <div class="field-type">varies by message type</div>
            <div class="field-size">N bytes</div>
          </div>
        </div>
        <div class="field-desc"><strong>id:</strong> A 16-bit identifier assigned by the program that generates any kind of query. This identifier is copied into the corresponding reply and can be used by the requester to match up replies to outstanding queries.</div>
        <div class="field-desc"><strong>qr:</strong> Query/Response flag - 1 bit that specifies whether this message is a query (0) or a response (1)</div>
        <div class="field-desc"><strong>opcode:</strong> Operation code - 4 bits specifying the kind of query. Set by originator, copied into response. 0=standard query (QUERY), 1=inverse query (IQUERY), 2=server status request (STATUS), 3-15=reserved for future use</div>
        <div class="field-desc"><strong>aa:</strong> Authoritative Answer - 1 bit valid in responses. Specifies that the responding name server is an authority for the domain name in the question section. Note: AA corresponds to the name matching the query name, or the first owner name in the answer section</div>
        <div class="field-desc"><strong>tc:</strong> TrunCation - 1 bit specifying that this message was truncated due to length greater than that permitted on the transmission channel (512 bytes for UDP)</div>
        <div class="field-desc"><strong>rd:</strong> Recursion Desired - 1 bit that may be set in a query and is copied into the response. If set, it directs the name server to pursue the query recursively. Recursive query support is optional</div>
        <div class="field-desc"><strong>ra:</strong> Recursion Available - 1 bit set or cleared in a response. Denotes whether recursive query support is available in the name server</div>
        <div class="field-desc"><strong>z:</strong> Reserved for future use - 3 bits. Must be zero in all queries and responses</div>
        <div class="field-desc"><strong>rcode:</strong> Response code - 4 bits set as part of responses. 0=No error, 1=Format error (unable to interpret query), 2=Server failure, 3=Name Error (domain does not exist, only from authoritative server), 4=Not Implemented (query type not supported), 5=Refused (policy reasons), 6-15=reserved</div>
        <div class="field-desc"><strong>qdcount:</strong> An unsigned 16-bit integer specifying the number of entries in the question section</div>
        <div class="field-desc"><strong>ancount:</strong> An unsigned 16-bit integer specifying the number of resource records in the answer section</div>
        <div class="field-desc"><strong>nscount:</strong> An unsigned 16-bit integer specifying the number of name server resource records in the authority records section</div>
        <div class="field-desc"><strong>arcount:</strong> An unsigned 16-bit integer specifying the number of resource records in the additional records section</div>
        <div class="field-desc"><strong>payload:</strong> Message-specific data as defined by the message type. See individual message types below for payload structure.</div>

      <div class="example">
        <details open>
          <summary>Example: Complete frame with DNS_QUERY payload</summary>
          <div class="example-content">
            <p>Standard query for A record of example.com:</p>
              <div class="annotated-hex-view">
                <div class="hex-inline">
                  <span class="hex-segment" data-segment="frame-example-0" style="background-color: #dbeafe;">12 34</span>                  <span class="hex-segment" data-segment="frame-example-1" style="background-color: #fce7f3;"><svg class="binary-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256"><ellipse cx="94" cy="72" rx="30" ry="40" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/><ellipse cx="166" cy="184" rx="30" ry="40" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/><polyline points="176 112 176 32 152 45.33" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/><polyline points="96 224 96 144 72 157.33" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/></svg> 00000001 00000000</span>                  <span class="hex-segment" data-segment="frame-example-2" style="background-color: #fef3c7;">00 01</span>                  <span class="hex-segment" data-segment="frame-example-3" style="background-color: #d1fae5;">00 00</span>                  <span class="hex-segment" data-segment="frame-example-4" style="background-color: #e9d5ff;">00 00</span>                  <span class="hex-segment" data-segment="frame-example-5" style="background-color: #fed7aa;">00 00</span>                  <span class="hex-segment" data-segment="frame-example-6" style="background-color: #dbeafe;">07</span>                  <span class="hex-segment" data-segment="frame-example-7" style="background-color: #fce7f3;">65 78 61 6D 70 6C 65</span>                  <span class="hex-segment" data-segment="frame-example-8" style="background-color: #fef3c7;">03</span>                  <span class="hex-segment" data-segment="frame-example-9" style="background-color: #d1fae5;">63 6F 6D</span>                  <span class="hex-segment" data-segment="frame-example-10" style="background-color: #e9d5ff;">00</span>                  <span class="hex-segment" data-segment="frame-example-11" style="background-color: #fed7aa;">00 01</span>                  <span class="hex-segment" data-segment="frame-example-12" style="background-color: #dbeafe;">00 01</span>
                </div>
                <div class="hex-annotations">
                  <div class="annotation" data-segment="frame-example-0" style="border-left-color: #dbeafe;">
                    <strong>Bytes 0-1:</strong> id (uint16): 4660
                  </div>
                  <div class="annotation" data-segment="frame-example-1" style="border-left-color: #fce7f3;">
                    <strong>Bytes 2-3 (bits):</strong>
                    <ul class="bitfield-list">
                      <li><code>qr</code> = 0 (bit 0)</li>
                      <li><code>opcode</code> = 0 (bits 1-4)</li>
                      <li><code>aa</code> = 0 (bit 5)</li>
                      <li><code>tc</code> = 0 (bit 6)</li>
                      <li><code>rd</code> = 1 (bit 7)</li>
                      <li><code>ra</code> = 0 (bit 8)</li>
                      <li><code>z</code> = 0 (bits 9-11)</li>
                      <li><code>rcode</code> = 0 (bits 12-15)</li>
                    </ul>
                  </div>
                  <div class="annotation" data-segment="frame-example-2" style="border-left-color: #fef3c7;">
                    <strong>Bytes 4-5:</strong> qdcount (uint16): 1
                  </div>
                  <div class="annotation" data-segment="frame-example-3" style="border-left-color: #d1fae5;">
                    <strong>Bytes 6-7:</strong> ancount (uint16): 0
                  </div>
                  <div class="annotation" data-segment="frame-example-4" style="border-left-color: #e9d5ff;">
                    <strong>Bytes 8-9:</strong> nscount (uint16): 0
                  </div>
                  <div class="annotation" data-segment="frame-example-5" style="border-left-color: #fed7aa;">
                    <strong>Bytes 10-11:</strong> arcount (uint16): 0
                  </div>
                  <div class="annotation" data-segment="frame-example-6" style="border-left-color: #dbeafe;">
                    <strong>Byte 12:</strong> qname[0] length (uint8): 7
                  </div>
                  <div class="annotation" data-segment="frame-example-7" style="border-left-color: #fce7f3;">
                    <strong>Bytes 13-19:</strong> qname[0] (string): &#039;example&#039;
                  </div>
                  <div class="annotation" data-segment="frame-example-8" style="border-left-color: #fef3c7;">
                    <strong>Byte 20:</strong> qname[1] length (uint8): 3
                  </div>
                  <div class="annotation" data-segment="frame-example-9" style="border-left-color: #d1fae5;">
                    <strong>Bytes 21-23:</strong> qname[1] (string): &#039;com&#039;
                  </div>
                  <div class="annotation" data-segment="frame-example-10" style="border-left-color: #e9d5ff;">
                    <strong>Byte 24:</strong> qname terminator (uint8): 0
                  </div>
                  <div class="annotation" data-segment="frame-example-11" style="border-left-color: #fed7aa;">
                    <strong>Bytes 25-26:</strong> qtype (uint16): 1
                  </div>
                  <div class="annotation" data-segment="frame-example-12" style="border-left-color: #dbeafe;">
                    <strong>Bytes 27-28:</strong> qclass (uint16): 1
                  </div>
                </div>
              </div>
          </div>
        </details>
      </div>
      </div>
    </section>

    <section id="data-types" class="section">
      <h2>Data Types</h2>
      <div class="type-list">
        <details class="type-details">
          <summary><h3>Primitive Types</h3></summary>
          <table class="types-table">
            <thead>
              <tr><th>Type</th><th>Size</th><th>Description</th><th>Range</th></tr>
            </thead>
            <tbody>
              <tr><td>uint8</td><td>1 byte</td><td>Unsigned 8-bit integer</td><td>0 to 255</td></tr>
              <tr><td>uint16</td><td>2 bytes</td><td>Unsigned 16-bit integer (big-endian)</td><td>0 to 65,535</td></tr>
              <tr><td>uint32</td><td>4 bytes</td><td>Unsigned 32-bit integer (big-endian)</td><td>0 to 4.29×10<sup>9</sup></td></tr>
              <tr><td>uint64</td><td>8 bytes</td><td>Unsigned 64-bit integer (big-endian)</td><td>0 to 1.84×10<sup>19</sup></td></tr>
              <tr><td>int8</td><td>1 byte</td><td>Signed 8-bit integer</td><td>-128 to 127</td></tr>
              <tr><td>int16</td><td>2 bytes</td><td>Signed 16-bit integer (big-endian)</td><td>-32,768 to 32,767</td></tr>
              <tr><td>int32</td><td>4 bytes</td><td>Signed 32-bit integer (big-endian)</td><td>-2.15×10<sup>9</sup> to 2.15×10<sup>9</sup></td></tr>
              <tr><td>int64</td><td>8 bytes</td><td>Signed 64-bit integer (big-endian)</td><td>-9.22×10<sup>18</sup> to 9.22×10<sup>18</sup></td></tr>
              <tr><td>float32</td><td>4 bytes</td><td>32-bit floating point (IEEE 754)</td><td>±1.4×10<sup>-45</sup> to ±3.4×10<sup>38</sup></td></tr>
              <tr><td>float64</td><td>8 bytes</td><td>64-bit floating point (IEEE 754)</td><td>±4.9×10<sup>-324</sup> to ±1.8×10<sup>308</sup></td></tr>
            </tbody>
          </table>
        </details>
        <details class="type-details" id="type-DNSHeader">
          <summary><h3>DNSHeader</h3></summary>
          <p class="type-description">DNS message header - fixed 12 bytes at start of all DNS messages</p>
          <div class="wire-format">
            <div class="wire-diagram">
              <div class="field" style="flex: 2">
                <div class="field-name">id</div>
                <div class="field-type">uint16</div>
                <div class="field-size">2 bytes</div>
                
              </div>
              <div class="field" style="flex: 1">
                <div class="field-name">qr</div>
                <div class="field-type">bit&lt;1&gt;</div>
                <div class="field-size">1 bits</div>
                
              </div>
              <div class="field" style="flex: 1">
                <div class="field-name">opcode</div>
                <div class="field-type">bit&lt;4&gt;</div>
                <div class="field-size">4 bits</div>
                
              </div>
              <div class="field" style="flex: 1">
                <div class="field-name">aa</div>
                <div class="field-type">bit&lt;1&gt;</div>
                <div class="field-size">1 bits</div>
                
              </div>
              <div class="field" style="flex: 1">
                <div class="field-name">tc</div>
                <div class="field-type">bit&lt;1&gt;</div>
                <div class="field-size">1 bits</div>
                
              </div>
              <div class="field" style="flex: 1">
                <div class="field-name">rd</div>
                <div class="field-type">bit&lt;1&gt;</div>
                <div class="field-size">1 bits</div>
                
              </div>
              <div class="field" style="flex: 1">
                <div class="field-name">ra</div>
                <div class="field-type">bit&lt;1&gt;</div>
                <div class="field-size">1 bits</div>
                
              </div>
              <div class="field" style="flex: 1">
                <div class="field-name">z</div>
                <div class="field-type">bit&lt;3&gt;</div>
                <div class="field-size">3 bits</div>
                
              </div>
              <div class="field" style="flex: 1">
                <div class="field-name">rcode</div>
                <div class="field-type">bit&lt;4&gt;</div>
                <div class="field-size">4 bits</div>
                
              </div>
              <div class="field" style="flex: 2">
                <div class="field-name">qdcount</div>
                <div class="field-type">uint16</div>
                <div class="field-size">2 bytes</div>
                
              </div>
              <div class="field" style="flex: 2">
                <div class="field-name">ancount</div>
                <div class="field-type">uint16</div>
                <div class="field-size">2 bytes</div>
                
              </div>
              <div class="field" style="flex: 2">
                <div class="field-name">nscount</div>
                <div class="field-type">uint16</div>
                <div class="field-size">2 bytes</div>
                
              </div>
              <div class="field" style="flex: 2">
                <div class="field-name">arcount</div>
                <div class="field-type">uint16</div>
                <div class="field-size">2 bytes</div>
                
              </div>
            </div>
            <div class="field-desc"><strong>id:</strong> A 16-bit identifier assigned by the program that generates any kind of query. This identifier is copied into the corresponding reply and can be used by the requester to match up replies to outstanding queries.</div>
            <div class="field-desc"><strong>qr:</strong> Query/Response flag - 1 bit that specifies whether this message is a query (0) or a response (1)</div>
            <div class="field-desc"><strong>opcode:</strong> Operation code - 4 bits specifying the kind of query. Set by originator, copied into response. 0=standard query (QUERY), 1=inverse query (IQUERY), 2=server status request (STATUS), 3-15=reserved for future use</div>
            <div class="field-desc"><strong>aa:</strong> Authoritative Answer - 1 bit valid in responses. Specifies that the responding name server is an authority for the domain name in the question section. Note: AA corresponds to the name matching the query name, or the first owner name in the answer section</div>
            <div class="field-desc"><strong>tc:</strong> TrunCation - 1 bit specifying that this message was truncated due to length greater than that permitted on the transmission channel (512 bytes for UDP)</div>
            <div class="field-desc"><strong>rd:</strong> Recursion Desired - 1 bit that may be set in a query and is copied into the response. If set, it directs the name server to pursue the query recursively. Recursive query support is optional</div>
            <div class="field-desc"><strong>ra:</strong> Recursion Available - 1 bit set or cleared in a response. Denotes whether recursive query support is available in the name server</div>
            <div class="field-desc"><strong>z:</strong> Reserved for future use - 3 bits. Must be zero in all queries and responses</div>
            <div class="field-desc"><strong>rcode:</strong> Response code - 4 bits set as part of responses. 0=No error, 1=Format error (unable to interpret query), 2=Server failure, 3=Name Error (domain does not exist, only from authoritative server), 4=Not Implemented (query type not supported), 5=Refused (policy reasons), 6-15=reserved</div>
            <div class="field-desc"><strong>qdcount:</strong> An unsigned 16-bit integer specifying the number of entries in the question section</div>
            <div class="field-desc"><strong>ancount:</strong> An unsigned 16-bit integer specifying the number of resource records in the answer section</div>
            <div class="field-desc"><strong>nscount:</strong> An unsigned 16-bit integer specifying the number of name server resource records in the authority records section</div>
            <div class="field-desc"><strong>arcount:</strong> An unsigned 16-bit integer specifying the number of resource records in the additional records section</div>
          </div>
        </details>
        <details class="type-details" id="type-Label">
          <summary><h3>Label</h3></summary>
          <p class="type-description">Single DNS label - length byte (0-63) followed by that many ASCII characters</p>
          <div class="wire-format">
            <div class="wire-diagram">
              <div class="field" style="flex: 1">
                <div class="field-name">length</div>
                <div class="field-type">uint8</div>
                <div class="field-size">1 byte</div>
              </div>
              <div class="field" style="flex: 4">
                <div class="field-name">data</div>
                <div class="field-type">ascii char[]</div>
                <div class="field-size">length × 1 byte</div>
              </div>
            </div>
          </div>
        </details>
        <details class="type-details" id="type-DomainName">
          <summary><h3>DomainName</h3></summary>
          <p class="type-description">Complete domain name - sequence of labels terminated by zero-length label</p>
          <div class="wire-format">
            <div class="wire-diagram">
              <div class="field" style="flex: 4">
                <div class="field-name">data</div>
                <div class="field-type"><a href="#type-Label" class="type-link">Label</a>[]</div>
                <div class="field-size">variable</div>
              </div>
              <div class="field" style="flex: 1">
                <div class="field-name">null</div>
                <div class="field-type">0x00</div>
                <div class="field-size">1 byte</div>
              </div>
            </div>
          </div>
        </details>
        <details class="type-details" id="type-Pointer">
          <summary><h3>Pointer</h3></summary>
          <p class="type-description">DNS compression pointer - 2 bytes where top 2 bits are 11, followed by 14-bit offset from start of DNS message</p>
          <p class="type-alias">
            Type alias: <code>uint16</code>
          </p>
        </details>
        <details class="type-details" id="type-Question">
          <summary><h3>Question</h3></summary>
          <p class="type-description">Question section entry - what is being asked</p>
          <div class="wire-format">
            <div class="wire-diagram">
              <div class="field" style="flex: 4">
                <div class="field-name">qname</div>
                <div class="field-type"><a href="#type-DomainName" class="type-link">DomainName</a> | <a href="#type-Pointer" class="type-link">Pointer</a></div>
                <div class="field-size">variable</div>
                
              </div>
              <div class="field" style="flex: 2">
                <div class="field-name">qtype</div>
                <div class="field-type">uint16</div>
                <div class="field-size">2 bytes</div>
                
              </div>
              <div class="field" style="flex: 2">
                <div class="field-name">qclass</div>
                <div class="field-type">uint16</div>
                <div class="field-size">2 bytes</div>
                
              </div>
            </div>
            <div class="field-desc"><strong>qname:</strong> A domain name represented as a sequence of labels. Each label consists of a length octet followed by that number of octets. The domain name terminates with the zero length octet for the null label of the root. May be an odd number of octets; no padding is used</div>
            <div class="field-desc"><strong>qtype:</strong> A two-octet code which specifies the type of the query. Values include all TYPE codes plus some more general codes which can match more than one type: 1=A, 2=NS, 5=CNAME, 6=SOA, 12=PTR, 15=MX, 16=TXT, 28=AAAA, 252=AXFR (zone transfer), 255=* (all records)</div>
            <div class="field-desc"><strong>qclass:</strong> A two-octet code that specifies the class of the query. 1=IN (Internet), 2=CS (CSNET, obsolete), 3=CH (CHAOS), 4=HS (Hesiod), 255=* (any class)</div>
          </div>
        </details>
        <details class="type-details" id="type-ResourceRecord">
          <summary><h3>ResourceRecord</h3></summary>
          <p class="type-description">Resource record - answer/authority/additional section entry</p>
          <div class="wire-format">
            <div class="wire-diagram">
              <div class="field" style="flex: 4">
                <div class="field-name">name</div>
                <div class="field-type"><a href="#type-DomainName" class="type-link">DomainName</a> | <a href="#type-Pointer" class="type-link">Pointer</a></div>
                <div class="field-size">variable</div>
                
              </div>
              <div class="field" style="flex: 2">
                <div class="field-name">rtype</div>
                <div class="field-type">uint16</div>
                <div class="field-size">2 bytes</div>
                
              </div>
              <div class="field" style="flex: 2">
                <div class="field-name">rclass</div>
                <div class="field-type">uint16</div>
                <div class="field-size">2 bytes</div>
                
              </div>
              <div class="field" style="flex: 4">
                <div class="field-name">ttl</div>
                <div class="field-type">uint32</div>
                <div class="field-size">4 bytes</div>
                
              </div>
              <div class="field" style="flex: 2">
                <div class="field-name">rdlength</div>
                <div class="field-type">uint16</div>
                <div class="field-size">2 bytes</div>
                
              </div>
              <div class="field" style="flex: 4">
                <div class="field-name">rdata</div>
                <div class="field-type">uint8[] (<a href="#type-A_Record" class="type-link">A_Record</a> | <a href="#type-NS_Record" class="type-link">NS_Record</a> | <a href="#type-CNAME_Record" class="type-link">CNAME_Record</a> | <a href="#type-SOA_Record" class="type-link">SOA_Record</a> | <a href="#type-PTR_Record" class="type-link">PTR_Record</a> | <a href="#type-MX_Record" class="type-link">MX_Record</a> | <a href="#type-TXT_Record" class="type-link">TXT_Record</a> | <a href="#type-AAAA_Record" class="type-link">AAAA_Record</a>)</div>
                <div class="field-size">variable</div>
                
              </div>
            </div>
            <div class="field-desc"><strong>name:</strong> An owner name - the domain name to which this resource record pertains. Can be a domain name or a compression pointer (2 bytes starting with bits 11)</div>
            <div class="field-desc"><strong>rtype:</strong> Two octets containing one of the RR TYPE codes. Specifies the meaning of the data in the RDATA field. Common types: 1=A (host address), 2=NS (authoritative name server), 5=CNAME (canonical name), 6=SOA (start of authority), 12=PTR (domain name pointer), 15=MX (mail exchange), 16=TXT (text strings), 28=AAAA (IPv6 address)</div>
            <div class="field-desc"><strong>rclass:</strong> Two octets which specify the class of the data in the RDATA field. 1=IN (Internet), 3=CH (CHAOS), 4=HS (Hesiod)</div>
            <div class="field-desc"><strong>ttl:</strong> A 32-bit unsigned integer that specifies the time interval (in seconds) that the resource record may be cached before it should be discarded. Zero values mean the RR can only be used for the transaction in progress and should not be cached</div>
            <div class="field-desc"><strong>rdlength:</strong> An unsigned 16-bit integer that specifies the length in octets of the RDATA field</div>
          </div>
        </details>
        <details class="type-details" id="type-A_Record">
          <summary><h3>A_Record</h3></summary>
          <p class="type-description">A record RDATA - IPv4 address (TYPE=1, CLASS=IN)</p>
          <div class="wire-format">
            <div class="wire-diagram">
              <div class="field" style="flex: 4">
                <div class="field-name">address</div>
                <div class="field-type">uint32</div>
                <div class="field-size">4 bytes</div>
                
              </div>
            </div>
            <div class="field-desc"><strong>address:</strong> A 32-bit Internet address (IPv4). Hosts with multiple Internet addresses will have multiple A records</div>
          </div>
        </details>
        <details class="type-details" id="type-NS_Record">
          <summary><h3>NS_Record</h3></summary>
          <p class="type-description">NS record RDATA - authoritative name server (TYPE=2)</p>
          <div class="wire-format">
            <div class="wire-diagram">
              <div class="field" style="flex: 4">
                <div class="field-name">nsdname</div>
                <div class="field-type"><a href="#type-DomainName" class="type-link">DomainName</a> | <a href="#type-Pointer" class="type-link">Pointer</a></div>
                <div class="field-size">variable</div>
                
              </div>
            </div>
            <div class="field-desc"><strong>nsdname:</strong> A domain name which specifies a host which should be authoritative for the specified class and domain</div>
          </div>
        </details>
        <details class="type-details" id="type-CNAME_Record">
          <summary><h3>CNAME_Record</h3></summary>
          <p class="type-description">CNAME record RDATA - canonical name for an alias (TYPE=5)</p>
          <div class="wire-format">
            <div class="wire-diagram">
              <div class="field" style="flex: 4">
                <div class="field-name">cname</div>
                <div class="field-type"><a href="#type-DomainName" class="type-link">DomainName</a> | <a href="#type-Pointer" class="type-link">Pointer</a></div>
                <div class="field-size">variable</div>
                
              </div>
            </div>
            <div class="field-desc"><strong>cname:</strong> A domain name which specifies the canonical or primary name for the owner. The owner name is an alias</div>
          </div>
        </details>
        <details class="type-details" id="type-SOA_Record">
          <summary><h3>SOA_Record</h3></summary>
          <p class="type-description">SOA record RDATA - start of authority (TYPE=6)</p>
          <div class="wire-format">
            <div class="wire-diagram">
              <div class="field" style="flex: 4">
                <div class="field-name">mname</div>
                <div class="field-type"><a href="#type-DomainName" class="type-link">DomainName</a> | <a href="#type-Pointer" class="type-link">Pointer</a></div>
                <div class="field-size">variable</div>
                
              </div>
              <div class="field" style="flex: 4">
                <div class="field-name">rname</div>
                <div class="field-type"><a href="#type-DomainName" class="type-link">DomainName</a> | <a href="#type-Pointer" class="type-link">Pointer</a></div>
                <div class="field-size">variable</div>
                
              </div>
              <div class="field" style="flex: 4">
                <div class="field-name">serial</div>
                <div class="field-type">uint32</div>
                <div class="field-size">4 bytes</div>
                
              </div>
              <div class="field" style="flex: 4">
                <div class="field-name">refresh</div>
                <div class="field-type">uint32</div>
                <div class="field-size">4 bytes</div>
                
              </div>
              <div class="field" style="flex: 4">
                <div class="field-name">retry</div>
                <div class="field-type">uint32</div>
                <div class="field-size">4 bytes</div>
                
              </div>
              <div class="field" style="flex: 4">
                <div class="field-name">expire</div>
                <div class="field-type">uint32</div>
                <div class="field-size">4 bytes</div>
                
              </div>
              <div class="field" style="flex: 4">
                <div class="field-name">minimum</div>
                <div class="field-type">uint32</div>
                <div class="field-size">4 bytes</div>
                
              </div>
            </div>
            <div class="field-desc"><strong>mname:</strong> The domain name of the name server that was the original or primary source of data for this zone</div>
            <div class="field-desc"><strong>rname:</strong> A domain name which specifies the mailbox of the person responsible for this zone</div>
            <div class="field-desc"><strong>serial:</strong> The unsigned 32-bit version number of the original copy of the zone. Zone transfers preserve this value. Wraps and should be compared using sequence space arithmetic</div>
            <div class="field-desc"><strong>refresh:</strong> A 32-bit time interval (in seconds) before the zone should be refreshed</div>
            <div class="field-desc"><strong>retry:</strong> A 32-bit time interval (in seconds) that should elapse before a failed refresh should be retried</div>
            <div class="field-desc"><strong>expire:</strong> A 32-bit time value (in seconds) that specifies the upper limit on the time interval that can elapse before the zone is no longer authoritative</div>
            <div class="field-desc"><strong>minimum:</strong> The unsigned 32-bit minimum TTL field that should be exported with any RR from this zone</div>
          </div>
        </details>
        <details class="type-details" id="type-PTR_Record">
          <summary><h3>PTR_Record</h3></summary>
          <p class="type-description">PTR record RDATA - pointer to domain name (TYPE=12)</p>
          <div class="wire-format">
            <div class="wire-diagram">
              <div class="field" style="flex: 4">
                <div class="field-name">ptrdname</div>
                <div class="field-type"><a href="#type-DomainName" class="type-link">DomainName</a> | <a href="#type-Pointer" class="type-link">Pointer</a></div>
                <div class="field-size">variable</div>
                
              </div>
            </div>
            <div class="field-desc"><strong>ptrdname:</strong> A domain name which points to some location in the domain name space. Used in special domains (like IN-ADDR.ARPA) to point to some other location</div>
          </div>
        </details>
        <details class="type-details" id="type-MX_Record">
          <summary><h3>MX_Record</h3></summary>
          <p class="type-description">MX record RDATA - mail exchange (TYPE=15)</p>
          <div class="wire-format">
            <div class="wire-diagram">
              <div class="field" style="flex: 2">
                <div class="field-name">preference</div>
                <div class="field-type">uint16</div>
                <div class="field-size">2 bytes</div>
                
              </div>
              <div class="field" style="flex: 4">
                <div class="field-name">exchange</div>
                <div class="field-type"><a href="#type-DomainName" class="type-link">DomainName</a> | <a href="#type-Pointer" class="type-link">Pointer</a></div>
                <div class="field-size">variable</div>
                
              </div>
            </div>
            <div class="field-desc"><strong>preference:</strong> A 16-bit integer which specifies the preference given to this RR among others at the same owner. Lower values are preferred</div>
            <div class="field-desc"><strong>exchange:</strong> A domain name which specifies a host willing to act as a mail exchange for the owner name</div>
          </div>
        </details>
        <details class="type-details" id="type-TXT_Record">
          <summary><h3>TXT_Record</h3></summary>
          <p class="type-description">TXT record RDATA - text strings (TYPE=16)</p>
          <div class="wire-format">
            <div class="wire-diagram">
              <div class="field" style="flex: 1">
                <div class="field-name">length</div>
                <div class="field-type">uint8</div>
                <div class="field-size">1 byte</div>
              </div>
              <div class="field" style="flex: 4">
                <div class="field-name">data</div>
                <div class="field-type">uint8[]</div>
                <div class="field-size">length × 1 byte</div>
              </div>
            </div>
          </div>
        </details>
        <details class="type-details" id="type-AAAA_Record">
          <summary><h3>AAAA_Record</h3></summary>
          <p class="type-description">AAAA record RDATA - IPv6 address (TYPE=28, CLASS=IN)</p>
          <div class="wire-format">
            <div class="wire-diagram">
              <div class="field" style="flex: 8">
                <div class="field-name">address_high</div>
                <div class="field-type">uint64</div>
                <div class="field-size">8 bytes</div>
                
              </div>
              <div class="field" style="flex: 8">
                <div class="field-name">address_low</div>
                <div class="field-type">uint64</div>
                <div class="field-size">8 bytes</div>
                
              </div>
            </div>
            <div class="field-desc"><strong>address_high:</strong> Upper 64 bits of the 128-bit IPv6 address</div>
            <div class="field-desc"><strong>address_low:</strong> Lower 64 bits of the 128-bit IPv6 address</div>
          </div>
        </details>
      </div>
    </section>

    <section id="messages" class="section">
      <h2>Messages</h2>
      <h3>Client → Server Messages</h3>
            <table class="messages-table">
        <thead>
          <tr><th>Code</th><th>Name</th><th>Description</th></tr>
        </thead>
        <tbody>
          <tr>
            <td><code>Query</code></td>
            <td><a href="#msg-Query">DNS_QUERY</a></td>
            <td>DNS query message sent from a resolver to a name server requesting resolution of a domain name</td>
          </tr>
        </tbody>
      </table>

            <details class="message-details" id="msg-Query">
        <summary>
          <h4><code>Query</code> DNS_QUERY</h4>
        </summary>

        <p class="message-description">DNS query message sent from a resolver to a name server requesting resolution of a domain name</p>
        <div class="message-notes">
    <ul class="notes-list">
      <li><strong>QR bit = 0</strong> in all queries.</li>
      <li><strong>ID field</strong> should be randomly generated to match with responses and prevent spoofing.</li>
      <li><strong>RD bit = 1</strong> requests recursive resolution (server will recursively query other servers if needed).</li>
      <li><strong>QDCOUNT</strong> is typically 1 (one question). <strong>ANCOUNT, NSCOUNT, ARCOUNT</strong> are typically 0 in queries.</li>
      <li><strong>Example:</strong> Query for the IPv4 address (A record) of example.com with class IN</li>
    </ul>
        </div>
        <div class="wire-format">
          <div class="wire-diagram">
            <div class="field" style="flex: 4">
              <div class="field-name">qname</div>
              <div class="field-type"><a href="#type-DomainName" class="type-link">DomainName</a> | <a href="#type-Pointer" class="type-link">Pointer</a></div>
              <div class="field-size">variable</div>
              
            </div>
            <div class="field" style="flex: 2">
              <div class="field-name">qtype</div>
              <div class="field-type">uint16</div>
              <div class="field-size">2 bytes</div>
              
            </div>
            <div class="field" style="flex: 2">
              <div class="field-name">qclass</div>
              <div class="field-type">uint16</div>
              <div class="field-size">2 bytes</div>
              
            </div>
          </div>
          <div class="field-desc"><strong>qname:</strong> A domain name represented as a sequence of labels. Each label consists of a length octet followed by that number of octets. The domain name terminates with the zero length octet for the null label of the root. May be an odd number of octets; no padding is used</div>
          <div class="field-desc"><strong>qtype:</strong> A two-octet code which specifies the type of the query. Values include all TYPE codes plus some more general codes which can match more than one type: 1=A, 2=NS, 5=CNAME, 6=SOA, 12=PTR, 15=MX, 16=TXT, 28=AAAA, 252=AXFR (zone transfer), 255=* (all records)</div>
          <div class="field-desc"><strong>qclass:</strong> A two-octet code that specifies the class of the query. 1=IN (Internet), 2=CS (CSNET, obsolete), 3=CH (CHAOS), 4=HS (Hesiod), 255=* (any class)</div>
        </div>
        <details class="example">
          <summary>Wire Format Example</summary>
          <div class="example-content">
            <p>Standard query for A record of example.com</p>
            <div class="example-hex">
              <h5>Wire Format (Hex Bytes)</h5>
              <div class="annotated-hex-view">
                <div class="hex-inline">
                  <span class="hex-segment" data-segment="DNS_QUERY-0" style="background-color: #dbeafe;">07</span>                  <span class="hex-segment" data-segment="DNS_QUERY-1" style="background-color: #fce7f3;">65 78 61 6D 70 6C 65</span>                  <span class="hex-segment" data-segment="DNS_QUERY-2" style="background-color: #fef3c7;">03</span>                  <span class="hex-segment" data-segment="DNS_QUERY-3" style="background-color: #d1fae5;">63 6F 6D</span>                  <span class="hex-segment" data-segment="DNS_QUERY-4" style="background-color: #e9d5ff;">00</span>                  <span class="hex-segment" data-segment="DNS_QUERY-5" style="background-color: #fed7aa;">00 01</span>                  <span class="hex-segment" data-segment="DNS_QUERY-6" style="background-color: #dbeafe;">00 01</span>
                </div>
                <div class="hex-annotations">
                  <div class="annotation" data-segment="DNS_QUERY-0" style="border-left-color: #dbeafe;">
                    <strong>Byte 0:</strong> qname[0] length (uint8): 7
                  </div>
                  <div class="annotation" data-segment="DNS_QUERY-1" style="border-left-color: #fce7f3;">
                    <strong>Bytes 1-7:</strong> qname[0] (string): &#039;example&#039;
                  </div>
                  <div class="annotation" data-segment="DNS_QUERY-2" style="border-left-color: #fef3c7;">
                    <strong>Byte 8:</strong> qname[1] length (uint8): 3
                  </div>
                  <div class="annotation" data-segment="DNS_QUERY-3" style="border-left-color: #d1fae5;">
                    <strong>Bytes 9-11:</strong> qname[1] (string): &#039;com&#039;
                  </div>
                  <div class="annotation" data-segment="DNS_QUERY-4" style="border-left-color: #e9d5ff;">
                    <strong>Byte 12:</strong> qname terminator (uint8): 0
                  </div>
                  <div class="annotation" data-segment="DNS_QUERY-5" style="border-left-color: #fed7aa;">
                    <strong>Bytes 13-14:</strong> qtype (uint16): 1
                  </div>
                  <div class="annotation" data-segment="DNS_QUERY-6" style="border-left-color: #dbeafe;">
                    <strong>Bytes 15-16:</strong> qclass (uint16): 1
                  </div>
                </div>
              </div>
            </div>
            <div class="example-decoded">
              <h5>Decoded Payload</h5>
              <pre class="decoded">{
  &quot;qname&quot;: [
    &quot;example&quot;,
    &quot;com&quot;
  ],
  &quot;qtype&quot;: 1,
  &quot;qclass&quot;: 1
}</pre>
            </div>
          </div>
        </details>
      </details>


      <h3>Server → Client Messages</h3>
            <table class="messages-table">
        <thead>
          <tr><th>Code</th><th>Name</th><th>Description</th></tr>
        </thead>
        <tbody>
          <tr>
            <td><code>Response</code></td>
            <td><a href="#msg-Response">DNS_RESPONSE</a></td>
            <td>DNS response message sent from a name server to a resolver containing requested resource records or an error code</td>
          </tr>
        </tbody>
      </table>

            <details class="message-details" id="msg-Response">
        <summary>
          <h4><code>Response</code> DNS_RESPONSE</h4>
        </summary>

        <p class="message-description">DNS response message sent from a name server to a resolver containing requested resource records or an error code</p>
        <div class="message-notes">
    <ul class="notes-list">
      <li><strong>QR bit = 1</strong> in all responses.</li>
      <li><strong>ID field</strong> is copied from the query to allow matching.</li>
      <li><strong>Question section</strong> is copied from the query.</li>
      <li><strong>Answer section</strong> contains RRs that directly answer the question.</li>
      <li><strong>Authority section</strong> contains NS RRs pointing toward authoritative name servers.</li>
      <li><strong>Additional section</strong> contains RRs that relate to the query but are not strictly answers (e.g., A records for name servers listed in Authority section).</li>
      <li><strong>Message compression</strong> is commonly used in responses. Pointer 0xC00C (bits: 11000000 00001100) refers to offset 12, which is typically the start of the question section&#039;s QNAME.</li>
      <li><strong>RCODE field</strong> indicates success (0) or the type of error that occurred.</li>
      <li><strong>AA bit = 1</strong> if the server is authoritative for the domain (not a cached answer).</li>
      <li><strong>TC bit = 1</strong> if the response was truncated due to exceeding 512 bytes over UDP. Client should retry over TCP.</li>
    </ul>
        </div>
        <div class="wire-format">
          <div class="wire-diagram">
            <div class="field" style="flex: 4">
              <div class="field-name">name</div>
              <div class="field-type"><a href="#type-DomainName" class="type-link">DomainName</a> | <a href="#type-Pointer" class="type-link">Pointer</a></div>
              <div class="field-size">variable</div>
              
            </div>
            <div class="field" style="flex: 2">
              <div class="field-name">rtype</div>
              <div class="field-type">uint16</div>
              <div class="field-size">2 bytes</div>
              
            </div>
            <div class="field" style="flex: 2">
              <div class="field-name">rclass</div>
              <div class="field-type">uint16</div>
              <div class="field-size">2 bytes</div>
              
            </div>
            <div class="field" style="flex: 4">
              <div class="field-name">ttl</div>
              <div class="field-type">uint32</div>
              <div class="field-size">4 bytes</div>
              
            </div>
            <div class="field" style="flex: 2">
              <div class="field-name">rdlength</div>
              <div class="field-type">uint16</div>
              <div class="field-size">2 bytes</div>
              
            </div>
            <div class="field" style="flex: 4">
              <div class="field-name">rdata</div>
              <div class="field-type">uint8[] (<a href="#type-A_Record" class="type-link">A_Record</a> | <a href="#type-NS_Record" class="type-link">NS_Record</a> | <a href="#type-CNAME_Record" class="type-link">CNAME_Record</a> | <a href="#type-SOA_Record" class="type-link">SOA_Record</a> | <a href="#type-PTR_Record" class="type-link">PTR_Record</a> | <a href="#type-MX_Record" class="type-link">MX_Record</a> | <a href="#type-TXT_Record" class="type-link">TXT_Record</a> | <a href="#type-AAAA_Record" class="type-link">AAAA_Record</a>)</div>
              <div class="field-size">variable</div>
              
            </div>
          </div>
          <div class="field-desc"><strong>name:</strong> An owner name - the domain name to which this resource record pertains. Can be a domain name or a compression pointer (2 bytes starting with bits 11)</div>
          <div class="field-desc"><strong>rtype:</strong> Two octets containing one of the RR TYPE codes. Specifies the meaning of the data in the RDATA field. Common types: 1=A (host address), 2=NS (authoritative name server), 5=CNAME (canonical name), 6=SOA (start of authority), 12=PTR (domain name pointer), 15=MX (mail exchange), 16=TXT (text strings), 28=AAAA (IPv6 address)</div>
          <div class="field-desc"><strong>rclass:</strong> Two octets which specify the class of the data in the RDATA field. 1=IN (Internet), 3=CH (CHAOS), 4=HS (Hesiod)</div>
          <div class="field-desc"><strong>ttl:</strong> A 32-bit unsigned integer that specifies the time interval (in seconds) that the resource record may be cached before it should be discarded. Zero values mean the RR can only be used for the transaction in progress and should not be cached</div>
          <div class="field-desc"><strong>rdlength:</strong> An unsigned 16-bit integer that specifies the length in octets of the RDATA field</div>
        </div>
        <details class="example">
          <summary>Wire Format Example</summary>
          <div class="example-content">
            <p>Response with A record for google.com → 142.250.185.46 (uncompressed)</p>
            <div class="example-hex">
              <h5>Wire Format (Hex Bytes)</h5>
              <div class="annotated-hex-view">
                <div class="hex-inline">
                  <span class="hex-segment" data-segment="DNS_RESPONSE-0" style="background-color: #dbeafe;">06</span>                  <span class="hex-segment" data-segment="DNS_RESPONSE-1" style="background-color: #fce7f3;">67 6F 6F 67 6C 65</span>                  <span class="hex-segment" data-segment="DNS_RESPONSE-2" style="background-color: #fef3c7;">03</span>                  <span class="hex-segment" data-segment="DNS_RESPONSE-3" style="background-color: #d1fae5;">63 6F 6D</span>                  <span class="hex-segment" data-segment="DNS_RESPONSE-4" style="background-color: #e9d5ff;">00</span>                  <span class="hex-segment" data-segment="DNS_RESPONSE-5" style="background-color: #fed7aa;">00 01</span>                  <span class="hex-segment" data-segment="DNS_RESPONSE-6" style="background-color: #dbeafe;">00 01</span>                  <span class="hex-segment" data-segment="DNS_RESPONSE-7" style="background-color: #fce7f3;">00 01 51 80</span>                  <span class="hex-segment" data-segment="DNS_RESPONSE-8" style="background-color: #fef3c7;">00 04</span>                  <span class="hex-segment" data-segment="DNS_RESPONSE-9" style="background-color: #d1fae5;">8E FA B9 2E</span>
                </div>
                <div class="hex-annotations">
                  <div class="annotation" data-segment="DNS_RESPONSE-0" style="border-left-color: #dbeafe;">
                    <strong>Byte 0:</strong> name[0] length (uint8): 6
                  </div>
                  <div class="annotation" data-segment="DNS_RESPONSE-1" style="border-left-color: #fce7f3;">
                    <strong>Bytes 1-6:</strong> name[0] (string): &#039;google&#039;
                  </div>
                  <div class="annotation" data-segment="DNS_RESPONSE-2" style="border-left-color: #fef3c7;">
                    <strong>Byte 7:</strong> name[1] length (uint8): 3
                  </div>
                  <div class="annotation" data-segment="DNS_RESPONSE-3" style="border-left-color: #d1fae5;">
                    <strong>Bytes 8-10:</strong> name[1] (string): &#039;com&#039;
                  </div>
                  <div class="annotation" data-segment="DNS_RESPONSE-4" style="border-left-color: #e9d5ff;">
                    <strong>Byte 11:</strong> name terminator (uint8): 0
                  </div>
                  <div class="annotation" data-segment="DNS_RESPONSE-5" style="border-left-color: #fed7aa;">
                    <strong>Bytes 12-13:</strong> rtype (uint16): 1
                  </div>
                  <div class="annotation" data-segment="DNS_RESPONSE-6" style="border-left-color: #dbeafe;">
                    <strong>Bytes 14-15:</strong> rclass (uint16): 1
                  </div>
                  <div class="annotation" data-segment="DNS_RESPONSE-7" style="border-left-color: #fce7f3;">
                    <strong>Bytes 16-19:</strong> ttl (uint32): 86400
                  </div>
                  <div class="annotation" data-segment="DNS_RESPONSE-8" style="border-left-color: #fef3c7;">
                    <strong>Bytes 20-21:</strong> rdlength (uint16): 4
                  </div>
                  <div class="annotation" data-segment="DNS_RESPONSE-9" style="border-left-color: #d1fae5;">
                    <strong>Bytes 22-25:</strong> rdata (uint8[]): [142,250,185,46]
                  </div>
                </div>
              </div>
            </div>
            <div class="example-decoded">
              <h5>Decoded Payload</h5>
              <pre class="decoded">{
  &quot;name&quot;: [
    &quot;google&quot;,
    &quot;com&quot;
  ],
  &quot;rtype&quot;: 1,
  &quot;rclass&quot;: 1,
  &quot;ttl&quot;: 86400,
  &quot;rdlength&quot;: 4,
  &quot;rdata&quot;: [
    142,
    250,
    185,
    46
  ]
}</pre>
            </div>
          </div>
        </details>
      </details>


    </section>

  </main>

  <footer>
    <p>Generated by BinSchema HTML Generator</p>
  </footer>

  <script>
    // Cross-highlight hex segments and annotations on hover
    document.addEventListener('DOMContentLoaded', () => {
      const segments = document.querySelectorAll('.hex-segment');
      const annotations = document.querySelectorAll('.annotation');

      segments.forEach(segment => {
        const id = segment.dataset.segment;
        const matchingAnnotation = document.querySelector(`.annotation[data-segment="${id}"]`);

        segment.addEventListener('mouseenter', () => {
          if (matchingAnnotation) matchingAnnotation.classList.add('highlight');
        });

        segment.addEventListener('mouseleave', () => {
          if (matchingAnnotation) matchingAnnotation.classList.remove('highlight');
        });
      });

      annotations.forEach(annotation => {
        const id = annotation.dataset.segment;
        const matchingSegment = document.querySelector(`.hex-segment[data-segment="${id}"]`);

        annotation.addEventListener('mouseenter', () => {
          if (matchingSegment) matchingSegment.classList.add('highlight');
        });

        annotation.addEventListener('mouseleave', () => {
          if (matchingSegment) matchingSegment.classList.remove('highlight');
        });
      });
    });
  </script>
</body>
</html>